<div *ngIf="visibilityStatus === 0" class="filmDetailsWrapper">
  <h1>Film</h1>

  <div class="backButtonDIV">
    <p-button
      label="zur端ck zur Suche"
      (onClick)="navigateToMultiSearch()"
      severity="secondary"
      icon="pi pi-arrow-left"
    />
  </div>
  <div *ngIf="hasError">
    <p-panel header="Fehler beim Laden der Seite" class="error">
      <p>
        Leider ist beim Laden der Season ein Fehler aufgetreten. Bitte versuchen
        Sie es erneut durch ein erneutes Laden der Seite.
      </p>
    </p-panel>
  </div>

  <div *ngIf="isInvalidID">
    <p-panel header="Fehler beim Laden der Seite" class="error">
      <p>
        Die eingegebene ID in der URL ist ung端ltig. Bitte versuchen Sie es
        erneut durch ein Zur端ckgehen zur letzten Seite und ein erneutes Laden
        dieser Seite.
      </p>
    </p-panel>
  </div>

  <div *ngIf="filmData$ | async as filmData">
    <div class="seasonMeta">
      <div class="seasonPictureWrapper">
        <div class="seasonMetaPicture">
          <p *ngIf="filmData.media.posterPath === null">kein Bild vorhanden</p>
          <img
            *ngIf="filmData.media.posterPath !== null"
            [src]="
              'https://image.tmdb.org/t/p/w500' + filmData.media.posterPath
            "
            [alt]="'Dies ist das Bild f端r von ' + filmData.media.name"
          />
        </div>
      </div>
      <div class="seasonMetaContent">
        <div>
          <h2>Beschreibung</h2>
          <p class="descriptionP">{{ filmData.media.description }}</p>
          <p>
            Ausstrahlung am {{ filmData.media.firstAirDate | dateFormatting }}
          </p>
          <p *ngIf="filmData.media.seasons.length > 0">
            Anzahl der Staffeln: {{ filmData.media.seasons.length }}
          </p>
        </div>
      </div>
    </div>

    <div class="newWatchlistButton">
      <p-panel
        *ngFor="let tracklist of filmData.tracklists; let i = index"
        [header]="tracklist.tracklistName"
        [toggleable]="true"
        [collapsed]="true"
      >
        <p>Status: {{ tracklist.status }}</p>
        <p-button
          label="Tracklist bearbeiten"
          icon="pi pi-pencil"
          (onClick)="setSelectedTracklist(tracklist)"
        />
      </p-panel>
    </div>

    <div class="newWatchlisButton">
      <p-button
        label="Neue Watchlist erstellen"
        icon="pi pi-plus"
        (onClick)="setVisibilityStatus(1)"
      />
    </div>
  </div>
</div>

<ng-container *ngIf="visibilityStatus === 1 && (filmData$ | async) as filmData">
  <app-create-movie-tracklist
    [mediaID]="filmData.media.id"
    [mediaName]="filmData.media.name"
    (cancelTracklistCreation)="setVisibilityStatus(0)"
    (saveNewTracklist)="refreshPage()"
  />
</ng-container>

<ng-container
  *ngIf="
    visibilityStatus === 2 &&
    selectedTracklist &&
    (filmData$ | async) as filmData
  "
>
  <app-update-film-tracklist
    [inpTracklist]="selectedTracklist"
    (cancelTracklistForm)="setVisibilityStatus(0)"
    (refreshFilmPage)="refreshPage()"
  />
</ng-container>
