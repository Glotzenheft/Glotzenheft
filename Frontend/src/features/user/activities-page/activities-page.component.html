<div class="pagination">
  <p-button
    icon="pi pi-angle-left"
    pTooltip="vorherige Seite"
    [rounded]="true"
    [raised]="true"
    (onClick)="changeToPreviousPage()"
    [disabled]="isLeftButtonDisabled"
  />

  <div>
    Seite
    <p-select
      [options]="pageOptions"
      [ngModel]="currentPage"
      (ngModelChange)="onPageSelect($event)"
      [style]="{width: '6rem'}"
    />
    <span> von {{ totalPages }} - Gesamtaktivitäten: <strong>{{ totalResults }}</strong></span>
  </div>


  <p-button
    icon="pi pi-angle-right"
    pTooltip="nächste Seite"
    [rounded]="true"
    [raised]="true"
    (onClick)="changeToNextPage()"
    [disabled]="isRightButtonDisabled"
  />
</div>

<div *ngIf="isLoading" class="loadingWrapper">
  <h1>Laden ...</h1>
  <p-progress-spinner
    ariaLabel="loading"
    strokeWidth="8"
    [style]="{ width: '5rem', height: '5rem' }"
  />
</div>

<div *ngIf="serverNotAvailablePage" class="serverNotAvailableDIV">
  <h1>Server nicht erreichbar</h1>
</div>

<ng-container *ngIf="!isLoading && !serverNotAvailablePage">
  <div
    *ngIf="userActivitiesRequest$ | async "
    class="userActivitiesTable"
  >
    <div class="userActivitesTableDIV">
      <p-table
        [value]="userActivitiesListWithDaySplitter"
        stripedRows
        [loading]="isTableLoading"
      >
        <ng-template #header>
          <tr>
            <th>Vorschau/Poster</th>
            <th>Datum</th>
            <th>Episode</th>
            <th>Laufzeit</th>
            <th>Film/Serie</th>
            <th>Tracklist-Name</th>
          </tr>
        </ng-template>

        <ng-template #body let-tracklist>
          <tr *ngIf="!tracklist.isDateSplitter">
            <td>
              <ng-container *ngIf="tracklist.picture as picture; else noImage">
                <img
                  [src]="posterPath + picture"
                  [alt]="
                    'Cover von ' +
                    tracklist.mediaTitle +
                    (tracklist.episodeNumber
                      ? ' - Episode ' + tracklist.episodeNumber
                      : '')
                  "
                  loading="lazy"
                />
              </ng-container>
              <ng-template #noImage>
                <i>kein Bild vorhanden</i>
              </ng-template>
            </td>
            <td>
              {{ tracklist.date | dateFormatting }}
            </td>
            <td>
              {{
                tracklist.episodeNumber !== null
                  ? "E" + tracklist.episodeNumber.toString().padStart(2, "0")
                  : "-"
              }}
            </td>
            <td>{{ tracklist.runtime }} min</td>
            <td>
              <p class="mediaRow" (click)="onClickActivity(tracklist)">
                {{ tracklist.mediaTitle }}
              </p>
            </td>
            <td>{{ tracklist.tracklistName }}</td>
          </tr>

          <tr *ngIf="tracklist.isDateSplitter">
            <td>
              <b>{{ tracklist.date }}</b>
            </td>
            <td></td>
            <td></td>
            <td></td>
            <td>
              <b>Geschaut: {{ tracklist.episodeID }}x</b>
            </td>
            <td>
              <b>{{ tracklist.runtime }} Minuten</b>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  <div class="gapDIV"></div>
</ng-container>
